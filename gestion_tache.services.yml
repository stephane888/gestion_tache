services:
  # version 2x
  gestion_tache_v2.api:
    class: Drupal\gestion_tache\Services\Api\GestionProjectV2
    arguments: ['@gestion_tache_v2.manage_entity']
    
#  gestion_tache_v2.count_subtaches:
#    class: Drupal\gestion_tache\EventSubscriber\GestionProjectV2Subscriber
#    tags:
#      - { name: event_subscriber }
  
  gestion_tache_v2.access_entity_controller:
    class: Drupal\gestion_tache\Services\Api\AccessEntitiesController
    arguments: ['@entity_type.manager']
      
  gestion_tache_v2.manage_entity:
    class: Drupal\gestion_tache\Services\Api\ManageEntity
    arguments: ['@gestion_tache_v2.access_entity_controller']

  # le module jsonapi a decid√© de modifier le format de sortie des dates(https://www.drupal.org/node/2982678), mais cela n'est pas compatible avec d'autres module de drupal.
  # donc, on revient au format par defaut. (voir la doc : https://www.drupal.org/docs/8/api/serialization-api/changing-the-way-serializer-handles-entities ).
  gestion_tache_v2.normalizer.entity_reference_field_daterange:
    class: Drupal\gestion_tache\Normalizer\EntityReferenceFieldDaterangeNormalizer    
    tags:
      - { name: normalizer, priority: 1 }
    arguments: ['@entity.repository']
  
  
    
  # version 1x
  gestion_tache.api:
    class: Drupal\gestion_tache\Services\GestionProject\GestionProject
    arguments: ['@gestion_tache.search','@gestion_tache.load','@gestion_tache.breackcrumb']
    
  gestion_tache.search:
    class: Drupal\gestion_tache\Services\GestionProject\Ressources\Search
    arguments: ['@database','@request_stack','@current_user']
    
  gestion_tache.load:
    class: Drupal\gestion_tache\Services\GestionProject\Ressources\Load
    arguments: ['@database','@request_stack','@current_user']
    
  gestion_tache.breackcrumb:
    class: Drupal\gestion_tache\Services\GestionProject\Ressources\BreackCrumb
    arguments: ['@database','@request_stack','@gestion_tache.load']